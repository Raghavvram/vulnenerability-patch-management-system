# Vulnerability Patch Management System

## Overview
This project is a modular, containerized vulnerability management platform. It automates the workflow from vulnerability scanning to patch prioritization using Nmap, enrichment, LLM analysis, and ML-based prioritization.

## Architecture
- **main_orchestrator**: Entry point for all API requests, coordinates the workflow.
- **parser_service**: Parses Nmap XML scan results.
- **enricher_service**: Enriches scan data with vulnerability info, stores in PostgreSQL.
- **llm_service**: Analyzes vulnerabilities using Perplexity Sonar LLM.
- **prioritization_engine**: Assigns priority and SLA timelines using ML and rules.
- **postgres**: Database for storing vulnerability data.
- **redis**: Caching and job status tracking.
- **grafana**: Dashboard for monitoring and visualization.
- **prometheus**: Metrics collection (optional).

## Quick Start
1. **Clone the repository**
2. **Run the deployment script:**
   ```
   bash deploy_vulnerability_management.sh
   ```
   This will build and start all services, set up environment variables, and initialize the database.

3. **Submit a scan for processing:**
   ```
   bash test_nmap_scan_and_submit.sh
   ```
   Or use curl:
   ```
   curl -X POST http://localhost:8000/scan/process \
     -H "Content-Type: application/json" \
     -d '{ "xml_content": "<nmaprun ...>...</nmaprun>" }'
   ```

4. **View results and dashboards:**
   - **Grafana:** [http://localhost:3000](http://localhost:3000) (default user: admin, password auto-generated)
   - **API Endpoints:**
     - Main Orchestrator: [http://localhost:8000](http://localhost:8000)
     - See individual service README.md files for internal endpoints.

## Monitoring & Health
- Each service exposes `/health` and `/metrics` endpoints for status and monitoring.
- Prometheus and Grafana are pre-configured for metrics and dashboards.

## Customization
- Edit `docker-compose.yml` to change service ports, add integrations, or adjust resource limits.
- Environment variables are set in `.env` (auto-generated by the deploy script).

## Troubleshooting
- Check container logs with:
  ```
  docker logs <container_name>
  ```
- If a service is unhealthy, restart it:
  ```
  docker restart <container_name>
  ```
- For API errors, see logs in the respective service folder.

## Advanced Usage
- Integrate with your own Nmap scans by updating the XML in `test_nmap_scan_and_submit.sh`.
- Extend enrichment, LLM, or ML logic by editing the respective Python service code.

## License
MIT
